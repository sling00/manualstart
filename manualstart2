#!/usr/bin/perl
#Manualstart V2.0 Perl edition! 
use warnings;
use strict;
require '/opt/ifmi/pm-common.pl';
use Term::ANSIScreen qw(cls);
use YAML qw( DumpFile LoadFile );
binmode STDOUT, ":utf8";
#use utf8;
 

use JSON;

use JSON;
 
my $json;
{
  local $/; #Enable 'slurp' mode
  open my $fh, "<", "manualstart2.conf";
  $json = <$fh>;
  close $fh;
}
my $data = decode_json($json);
# Output to screen one of the values read
#print "Debug is: " .
#      $data->{'Settings'}->{'Debug'}->[0] . "n";
# Modify the value, and write the output file as json
#$data->{'boss'}->{'Hobbies'}->[0] = "Swimming";
#open my $fh, ">", "data_out.json";
#print $fh encode_json($data);
#close $fh;
my $conf = &getConfig;
my %conf = %{$conf};
my $conffile = "/opt/ifmi/poolmanager.conf";
#Globals
sub THELINE {
	print "-================================================-\n";
}
my $clear_screen = cls();



sub readconf {
  my $msconffile = '/opt/pimp/manualstart.conf';
  if (! -e $msconffile) {
    exec('/usr/lib/cgi-bin/config.pl');
  } 
  my $c;
  $c = LoadFile($msconffile);
  return($c);
}
sub startup {
	print $clear_screen;
	&THELINE;
	print "Poolmanager Manual mining starter & profile tester\n";
	&THELINE;
}	

sub optionsmenu {
	print "Options\n";

	print "or done to return to the main menu.\n";
	print "Change option #: "; my $coption = <>;
	print "Debug is: " . $data->{'Settings'}->{'Debug'}->[0] . "n";
	if ($coption = 1 ) {
		print "\nTurning $coption on";
		&optionsmenu;
	}
	elsif ($coption = 2 ) {
		print "\nTurning $coption off";
		&optionsmenu;
	}
	elsif ($coption = m/d(one)?/i) {
		&mainmenu;
	}else {
		print "\nInvalid selection. Try again.\n"; &optionsmenu;
	}

}
sub mainmenu {
	&THELINE;
	print "Select an option from the menu below:\n";
	&THELINE;
	print "1. Change options\t 7.Start Heavy\n";
	print "2. scrypt\t  8. X11 (SPH-SGminer)\n";
	print "3. scrypt-n\t 9. X11 (X11mod miner)\n";
	print "4. Keccak(Sha3)\t 10. X13 (X13mod miner)\n";
	print "5. Quark\t 11. Scrypt ChaCha\n";
	print "6. Scrypt-Jane\t 12. Jackpotcoin\n";
	print "q - Quit\n";
	print "My Choice: "; my $choice = <>;
	if ($choice =~ 1) { &optionsmenu;
	}
	elsif ($choice =~ m/q(uit)?/i) {
	print "Exiting....";
	} else {
		print "Invalid selection. Try again.\n"; &mainmenu;
	}


}
&startup;
&mainmenu;

